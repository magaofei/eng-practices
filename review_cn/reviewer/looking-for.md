# 代码审查中要查找的内容



注意：始终确保考虑到
[代码审查标准]（standard.md）在考虑其中的每一个时
点。

## 设计

在评论中要涵盖的最重要的事情是CL的整体设计。
CL中各种代码的交互是否有意义？做这个
更改属于您的代码库，还是属于库？它是否与...完美融合？
你的系统的其余部分？现在是添加此功能的好时机吗？

## 功能

这个CL是否符合开发人员的意图？是开发人员想要的好事
对于此代码的用户？ “用户”通常都是最终用户（当他们时
受到变化的影响）和开发人员（他们将不得不“使用”此代码
未来）。

大多数情况下，我们希望开发人员能够很好地测试CL，使其正常工作
他们进行代码审查的时间。但是，作为评论者，你仍然应该如此
考虑边缘情况，寻找并发问题，试图思考
像一个用户，并确保没有你通过阅读看到的错误
代码。

如果你愿意，你*可以*验证CL  - 对于a来说最重要的时间
审核员检查CL的行为是否具有面向用户的影响，例如a
** UI更改**。很难理解某些更改会在何时影响用户
你只是在读代码。对于这样的更改，您可以让开发人员
如果在CL中修补太不方便，可以给你一个功能演示
并亲自尝试。

另一个时候考虑功能特别重要
在代码审查期间，是否存在某种**并行编程**
在理论上会导致死锁或竞争条件的CL中。这些
通常只运行代码就很难检测到各种各样的问题
需要某人（包括开发人员和审阅者）来思考它们
小心地确保没有引入问题。 （注意这是
也是一个很好的理由不使用竞争条件或者竞争条件的并发模型
死锁是可能的 - 它可以使代码审查变得非常复杂或
理解代码。）

## 复杂性

CL比它应该更复杂吗？在每个级别检查这个
CL-个别行太复杂了？功能太复杂了吗？课程也是
复杂？ “过于复杂”通常意味着**“代码无法快速理解
读者。“**它也可能意味着**”开发人员可能会在以后引入错误
他们试图调用或修改此代码。“**

特殊类型的复杂性是**过度工程**，开发人员拥有
使代码更通用，或者增加了功能
系统目前不需要。评审员应特别警惕
关于过度工程。鼓励开发人员解决他们所知道的问题
需要解决*现在*，而不是开发人员推测的问题*可能*
需要在将来解决。未来的问题一旦解决就应该解决
到了，你可以看到它在物理上的实际形状和要求
宇宙。

## 测试

要求单位，整合或端到端
适合变化的测试。一般来说，应该添加测试
除非CL正在处理，否则与生产代码相同的CL
[紧急]（../ emergencies.md）。

确保CL中的测试正确，合理且有用。测试做
不测试自己，我们很少为我们的测试编写测试 - 人类必须确保
测试有效。

当代码被破坏时，测试是否真的会失败？如果代码改变了
在他们之下，他们会开始产生误报吗？每个测试都有
简单而有用的断言？测试之间是否适当分开
不同的测试方法？

请记住，测试也是必须维护的代码。不要接受
测试中的复杂性仅仅因为它们不是主二进制文件的一部分。

## 命名

开发人员是否为所有内容选择了好名字？一个好名字足够长
完全沟通物品的作用或作用，而不是那么久
变得难以阅读。

## 评论

开发人员是否用可理解的英语撰写了清晰的评论？都是
评论其实有必要？通常评论在他们解释时很有用
为什么**存在一些代码，并且不应该解释*某些代码正在做什么。
如果代码不够清楚，无法解释自己，那么应该编写代码
简单。有一些例外（正则表达式和复杂算法
通常可以从解释他们正在做什么的评论中获益
例如）但主要是评论是针对代码本身不能提供的信息
可能包含，就像决定背后的推理一样。

查看此CL之前的注释也很有帮助。也许
有一个可以立即删除的TODO，一条评论建议不要改变这种情况
正在制作等

请注意，注释与类，模块或的* documentation *不同
函数，它应该代表一段代码的目的，如何
应该使用，以及它在使用时的行为方式。

##风格

我们在Google上有[样式指南]（http://google.github.io/styleguide/）
我们的主要语言，甚至是大多数次要语言。确保
CL遵循适当的样式指南。

如果您想要改进样式指南中没有的一些样式点，请添加前缀
你对“Nit：”的评论让开发人员知道这是你的挑剔
认为会改进代码，但不是强制性的。不要阻止CL
仅根据个人风格偏好提交。

CL的作者不应该包括与其他更改的主要样式更改
变化。它使得很难看到CL中的变化，进行合并
和回滚更复杂，并导致其他问题。例如，如果
作者想要重新格式化整个文件，让他们发送给你
重新格式化为一个CL，然后发送另一个CL功能
之后的变化。

## 文档

如果CL更改了用户构建，测试，交互或释放代码的方式，请检查
看到它还更新了相关文档，包括
README，g3doc页面和任何生成的页面
参考文档。如果CL删除或弃用代码，请考虑是否
文档也应该删除。
如果是文件
失踪，要求它。

## 每行{#every_line}

查看*已分配给您审核的每个*代码行。有些事情
比如您可以扫描的数据文件，生成的代码或大型数据结构
有时，但不要扫描人类编写的类，函数或代码块
并假设其中的内容是可以的。显然，一些代码值得更多
仔细审查比其他代码＆mdash;这是你必须的判断
make＆mdash;但你至少应该确定你*了解所有的东西
代码正在做。

如果您阅读代码太难了，这会减慢审核速度，
那么你应该让开发者知道这一点
并等待他们在您尝试审核之前澄清它。在谷歌，我们雇用
优秀的软件工程师，你就是其中之一。如果你无法理解的话
代码，很可能其他开发人员也不会。所以你也是
当您询问开发人员时，帮助未来的开发人员理解此代码
澄清一下。

如果您理解代码，但您觉得没有资格做某些部分
审查，确保CL上有一名合格的评审员，特别是
对于安全性，并发性，可访问性等复杂问题
国际化等

## 上下文

在广泛的背景下查看CL通常很有帮助。通常是代码
审核工具只会向您显示几行代码
被改变了。有时您必须查看整个文件以确保
改变实际上是有道理的例如，您可能只看到四个新行
正在添加，但是当你查看整个文件时，你会看到这四行
在一个50行的方法，现在真的需要分解成更小的方法。

在整个系统的上下文中考虑CL也很有用。
这个CL是否改善了系统的代码健康状况，还是整个系统的代码健康状况
系统更复杂，测试更少等？ **不要接受降低代码的CL
系统的健康。**大多数系统通过许多小的变化变得复杂
加起来，所以重要的是要防止新的复杂性
变化。

## Good Things {#good_things}

如果你在CL中看到一些不错的东西，请告诉开发人员，特别是在他们的时候
以一种很棒的方式解决了你的一条评论。代码审查通常只关注
错误，但他们应该提供鼓励和赞赏
实践也是如此。在指导方面，它有时甚至更有价值
告诉开发人员他们做得对，而不是告诉他们他们做错了什么。

## 摘要

在进行代码审查时，您应该确保：

 - 代码设计精良。
 - 该功能对代码用户有利。
 - 任何UI更改都是明智的，看起来很好。
 - 任何并行编程都是安全完成的。
 - 代码并不比它需要的复杂。
 - 开发人员没有实现他们*可能*将来需要的东西，但是
    不知道他们现在需要。
 - 代码有适当的单元测试。
 - 测试精心设计。
 - 开发人员使用了清晰的名称。
 - 评论清晰有用，主要解释*为什么*而不是*什么*。
 - 代码适当记录（通常在g3doc中）。
 - 代码符合我们的风格指南。

请务必查看**您要求查看的代码的每一行**，看看
**背景**，确保你**改善代码健康**和赞美
开发人员**好事**他们这样做。

下一页：[在审核中导航CL]（navigate.md）